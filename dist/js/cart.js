"use strict";$(function(){var n=JSON.parse(window.localStorage.getItem("cart"));console.log(n);for(var o=0,t=0;t<n.length;t++)o+=+n[t].cart_number;console.log(o);var e=getCookie("nickname");e&&($(".loginbut").addClass("hide"),$(".register").addClass("hide"),$(".usernameNick").html("尊敬的    ".concat(e,"      会员您好")),$(".cartNumber").html("(".concat(o,")")),$(".CartNumber").html("".concat(o)));e=getCookie("nickname");console.log(e),e?($(".off").addClass("hide"),$(".on").removeClass("hide")):($(".on").addClass("hide"),$(".off").removeClass("hide"));var s=JSON.parse(window.localStorage.getItem("cart"));function a(){var o=0,t=0;s.forEach(function(n){1==n.is_select&&(o+=+n.cart_number,t+=n.goods_price*n.cart_number)});var n=s.every(function(n){return 1==n.is_select});console.log(n);for(var e='\n    <div class="panel panel-info">\n    <div class="panel-heading">\n      <p class="selectAll">\n        <span>全选:</span>\n        <input type="checkbox" '.concat(n?"checked":"",' class="All">\n        <span class="text">购 物 清 单</span>\n      </p>\n    </div>\n    <div class="panel-body">\n      <ul class="goodsList">\n      '),a=0;a<s.length;a++)e+='\n        <li>\n          <div class="select">\n            <input type="checkbox" data-id = "'.concat(s[a].goods_id,'" ').concat(1==s[a].is_select?"checked":"",'>\n          </div>\n          <div class="goodsImg">\n            <img src="').concat(s[a].goods_small_logo,'" alt="" width="100px" height:\'100px\'>\n          </div>\n          <div class="goodsDesc">\n            <p>').concat(s[a].goods_name,'</p>\n          </div>\n          <div class="price">\n            ￥ <span class="text-danger">').concat(s[a].goods_price,'</span>\n          </div>\n          <div class="count">\n            <button data-id="').concat(s[a].goods_id,'" class="subNum">-</button>\n            <input type="text" value="').concat(s[a].cart_number,'">\n            <button data-id="').concat(s[a].goods_id,'" class="addNum">+</button>\n          </div>\n          <div class="xiaoji">\n            ￥ <span class="text-danger">').concat(s[a].cart_number*s[a].goods_price,'</span>\n          </div>\n          <div class="operate">\n            <button class="btn btn-danger delBtn" data-id="').concat(s[a].goods_id,'">删除</button>\n          </div>\n        </li>\n       ');e+=' \n      </ul>\n    </div>\n    <div class="panel-footer">\n      <div class="row buyInfo">\n        <p class="col-sm-2 buyNum">\n          购买总数量: <span class="text-danger cartNum">'.concat(o,'</span> 件商品\n        </p>\n        <p class="col-sm-3 buyMoney">\n          购买总价格: <span class="text-danger total">').concat(t,'</span> 元\n        </p>\n        <p class="col-sm-4 operate">\n          <button class="btn btn-success payMoney" disabled>立即付款</button>\n          <button class="btn btn-danger clearCart">清空购物车</button>\n          <a class="btn btn-primary" href="./list.html">继续购物</a>\n        </p>\n      </div>\n    </div>\n  </div>\n  '),console.log($(".total"),$(".payMoney"),$(".total").html()),$(".on").html(e),0!=$(".total").html()?$(".payMoney").removeAttr("disabled"):$(".payMoney").attr("disabled","disabled")}a(),$(".on ").on("click",".select input",function(){console.log(this);var n=this.checked,o=$(this).data("id");console.log(n,o);var t=s.filter(function(n){return n.goods_id==o})[0];console.log(t),t.is_select=n?1:0,a(),window.localStorage.setItem("cart",JSON.stringify(s))}),$(".on").on("click",".count .addNum",function(){console.log($(this).data("id"));var o=$(this).data("id"),n=+$(this).parent().children("input").val()+1;console.log(n),$(this).parent().children("input").val(n),console.log($(this).parent().children("input").val()),cart=$(this).parent().children("input").val();n=s.filter(function(n){return n.goods_id==o})[0];console.log(n),n.cart_number=cart,window.localStorage.setItem("cart",JSON.stringify(s)),a()}),$(".on").on("click",".count .subNum",function(){var o=$(this).data("id");console.log($(this).parent().children("input").val());var n=+$(this).parent().children("input").val()-1;if(console.log(n),0==n)for(var t=0;t<s.length;t++)if(s[t].goods_id==o)return s.splice(t,1),window.localStorage.setItem("cart",JSON.stringify(s)),a(),void console.log(s);$(this).parent().children("input").val(n);var e=s.filter(function(n){return n.goods_id==o})[0];console.log(e,$(this).parent().children("input").val()),e.cart_number=n,console.log(e.cart_number),window.localStorage.setItem("cart",JSON.stringify(s)),console.log(s),a()}),$(".on").on("click",".clearCart",function(){for(var n=0;n<s.length;n++)s.splice(n,1),n--;console.log(s),window.localStorage.setItem("cart",JSON.stringify(s)),a()}),$(".on").on("click",".payMoney",function(){console.log($("body")),$("body").append('<div class="payPage">富婆在等你</div>'),$(".payPage").css({width:"500px",height:"500px",position:"absolute",left:0,right:0,top:0,bottom:0,margin:"auto",zIndex:10,background:"url(../images/11.jpg)"}),$(".payPage").on("click",function(){console.log(123),$(".payPage").slideUp()})});s.every(function(n){return 1==n.is_select});$(".on").on("click",".All",function(){console.log(this);var n=this.checked;if(console.log(n),n){for(var o=0;o<s.length;o++)s[o].is_select=1;console.log(s)}else{for(var t=0;t<s.length;t++)s[t].is_select=0;console.log(s)}window.localStorage.setItem("cart",JSON.stringify(s)),a()}),$(".Sort").on("mouseover","li",function(){$(this).addClass("active").siblings().removeClass("active"),$(".SortMenue").stop().slideDown()}),$(".SortMenue").on("mouseout",function(){console.log(123123),$(this).removeClass("active"),$(".SortMenue").stop().slideUp()}),$(".on").on("click",".delBtn",function(){console.log("这是删除"),console.log($(this).data("id"));var o=$(this).data("id"),n=s.filter(function(n){return n.goods_id==o});console.log(n);for(var t=0;t<s.length;t++)s[t].goods_id==o&&(s.splice(t,1),console.log(s));console.log(s),window.localStorage.setItem("cart",JSON.stringify(s)),a()})});